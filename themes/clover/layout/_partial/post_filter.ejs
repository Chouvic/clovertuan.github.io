<% var filter_categories = _.isString(category) ? [category] : category; %>
<% var filter_tags = _.isString(tag) ? [tag] : tag; %>
<% var except_categories = _.isString(except_category) ? [except_category] : except_category; %>
<% var except_tags = _.isString(except_tag) ? [except_tag] : except_tag; %>
<%- partial('_partial/filter', {
  filter: function (post) {
    // 没有category或tag的时候 只看 except_category 和 except_tag
    if (!filter_categories && !filter_tags) {
      return !(_.find(post.categories.data, function (category) {
        return _.includes(except_categories, category.name);
      }) || _.find(post.tags.data, function (tag) {
        return _.includes(except_tags, tag.name);
      }));
    }
    // 在category或tag中 且不在except_category或except_tag 中
    return (_.find(post.categories.data, function (category) {
      return _.includes(filter_categories, category.name);
    }) || _.find(post.tags.data, function (tag) {
      return _.includes(filter_tags, tag.name);
    })) && !(_.find(post.categories.data, function (category) {
      return _.includes(except_categories, category.name);
    }) || _.find(post.tags.data, function (tag) {
      return _.includes(except_tags, tag.name);
    }));
  },
  card: card || 'project-card',
  showAll: showAll, // 只能show all 了
}) %>